# Автоматизация работы с графиком МВПС

Этот проект представляет собой скрипт автоматизации для взаимодействия с АРМ "Нарядчик", предназначенный для упрощения работы с "Графиком обслуживания поездов МВПС". Он автоматически запускает необходимые приложения, переходит к нужному разделу, проверяет наличие графиков и при необходимости создает новые, заполняя данные из внешнего Excel-файла.

## Быстрый старт

1.  Убедитесь, что у вас установлен Python 3.11 и необходимые библиотеки (`pywinauto`, `pandas`, `openpyxl`, `psutil`, `pyautogui` и др.). Вы можете установить зависимости, например, с помощью pip:
    ```bash
    pip install -r requirements.txt
    ```
2.  Поместите файл `График обслуживания поездов МВПС.xlsx` в корень проекта. Убедитесь, что он содержит нужные данные и даты в столбце O.
3.  Запустите главный файл приложения:
    ```bash
    python main.py
    ```
4.  В открывшемся окне нажмите кнопку **"Запустить ClientManager"**.
5.  Ход выполнения автоматизации будет отображаться как в самом окне приложения, так и записываться в файл `app.log` в корне проекта.

## Описание функциональности (по ТЗ)

Скрипт автоматически выполняет следующие действия:

1.  **Переход к разделу графиков**
    *   Переход осуществляется в модуле АРМ Нарядчика по пути: «Расписания» - «График обслуживания поездов МВПС»
2.  **Создание графика**
    *   Если график уже существует (определяется по совпадению имени и даты из таблицы выгрузки) - он используется
    *   Если график отсутствует - создаётся новый на основе данных из таблицы выгрузки
    *   В диалоговом окне указывается название графика, соответствующее полю «График оборота» в таблице
3.  **Установка периода действия графика**
    *   Выделяется нужный график
    *   Нажимается кнопка «Период»
    *   В появившемся окне выбирается дата действия графика, согласно полю «Дата графика» из таблицы
    *   Ставится галочка «Разрешить изменения»
    *   Год устанавливается вручную, если не совпадает
    *   После выбора даты правым кликом вызывается пункт «Закрепить» - дата помечается знаком «+»

*(Примечание: Текущая версия реализует переход, поиск/создание графика. Установка периода действия может требовать доработки).*

## Структура проекта

*   `main.py`: Главный файл запуска с графическим интерфейсом (Tkinter).
*   `gui_app.py`: Основная логика автоматизации (запуск приложений, взаимодействие с UI).
*   `excel_parser.py`: Модуль для чтения и парсинга данных из Excel-файла.
*   `const.py`: Файл с константами (пути, названия).
*   `График обслуживания поездов МВПС.xlsx`: Внешний файл с данными для автоматизации.
*   `app.log`: Файл журнала выполнения скрипта.